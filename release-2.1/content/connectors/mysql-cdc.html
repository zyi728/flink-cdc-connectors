

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>MySQL CDC Connector &mdash; Flink CDC  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Postgres CDC Connector" href="postgres-cdc.html" />
    <link rel="prev" title="Connectors" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Flink CDC
          

          
          </a>

          
            
            
              <div class="version">
                release-2.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about.html">What’s Flink CDC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B/index.html">快速上手</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Connectors</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">MySQL CDC Connector</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dependencies">Dependencies</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#maven-dependency">Maven dependency</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sql-client-jar">SQL Client JAR</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#setup-mysql-server">Setup MySQL server</a></li>
<li class="toctree-l3"><a class="reference internal" href="#notes">Notes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#set-a-different-server-id-for-each-reader">Set a different SERVER ID for each reader</a></li>
<li class="toctree-l4"><a class="reference internal" href="#setting-up-mysql-session-timeouts">Setting up MySQL session timeouts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#how-to-create-a-mysql-cdc-table">How to create a MySQL CDC table</a></li>
<li class="toctree-l3"><a class="reference internal" href="#connector-options">Connector Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="#available-metadata">Available Metadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="#features">Features</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#incremental-snapshot-reading">Incremental Snapshot Reading</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exactly-once-processing">Exactly-Once Processing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#startup-reading-position">Startup Reading Position</a></li>
<li class="toctree-l4"><a class="reference internal" href="#datastream-source">DataStream Source</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#data-type-mapping">Data Type Mapping</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mysql-spatial-data-types-mapping">MySQL Spatial Data Types Mapping</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#faq">FAQ</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#q1-how-to-skip-snapshot-and-only-read-from-binlog">Q1: How to skip snapshot and only read from binlog?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#q2-how-to-read-a-shared-database-that-contains-multiple-tables-e-g-user-00-user-01-user-99">Q2: How to read a shared database that contains multiple tables, e.g. user_00, user_01, …, user_99 ?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#q3-connectexception-received-dml-for-processing-binlog-probably-contains-events-generated-with-statement-or-mixed-based-replication-format">Q3: ConnectException: Received DML ‘…’ for processing, binlog probably contains events generated with statement or mixed based replication format</a></li>
<li class="toctree-l4"><a class="reference internal" href="#q4-mysql8-0-public-key-retrieval-is-not-allowed">Q4: Mysql8.0 Public Key Retrieval is not allowed ?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#q5-how-to-config-tablelist-option-when-build-mysql-cdc-source-in-datastream-api">Q5: How to config <code class="docutils literal notranslate"><span class="pre">tableList</span></code> option when build MySQL CDC source in DataStream API?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#q6-how-to-config-mysql-server-timezone-in-datastream-api">Q6: How to config MySQL server timezone in DataStream API?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="postgres-cdc.html">Postgres CDC Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="mongodb-cdc.html">MongoDB CDC Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="oracle-cdc.html">Oracle CDC Connector</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../formats/index.html">Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../downloads.html">Downloads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../githublink.html"><a class="github-button" href="https://github.com/ververica/flink-cdc-connectors" data-color-scheme="no-preference: dark_high_contrast; light: dark_high_contrast; dark: dark_high_contrast;" data-size="large" data-show-count="true" aria-label="Star ververica/flink-cdc-connectors on GitHub">Star</a></a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Flink CDC</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          <!--
  ~ Licensed to the Apache Software Foundation (ASF) under one
  ~ or more contributor license agreements.  See the NOTICE file
  ~ distributed with this work for additional information
  ~ regarding copyright ownership.  The ASF licenses this file
  ~ to you under the Apache License, Version 2.0 (the
  ~ "License"); you may not use this file except in compliance
  ~ with the License.  You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
-->

<!-- Extend the RTD template to support user defined "Edit on Github" URL -->

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Connectors</a> &raquo;</li>
        
      <li>MySQL CDC Connector</li>
    
    
            <li class="wy-breadcrumbs-aside">
                
                    
                        <a href="http://github.com/ververica/flink-cdc-connectors/blob/release-2.1/docs/content/connectors/mysql-cdc.md" class="fa fa-github"> Edit on GitHub</a>
                    
                
            </li>
        
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section class="tex2jax_ignore mathjax_ignore" id="mysql-cdc-connector">
<h1>MySQL CDC Connector<a class="headerlink" href="#mysql-cdc-connector" title="Permalink to this headline">¶</a></h1>
<p>The MySQL CDC connector allows for reading snapshot data and incremental data from MySQL database. This document describes how to setup the MySQL CDC connector to run SQL queries against MySQL databases.</p>
<section id="dependencies">
<h2>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h2>
<p>In order to setup the MySQL CDC connector, the following table provides dependency information for both projects using a build automation tool (such as Maven or SBT) and SQL Client with SQL JAR bundles.</p>
<section id="maven-dependency">
<h3>Maven dependency<a class="headerlink" href="#maven-dependency" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;dependency&gt;
  &lt;groupId&gt;com.ververica&lt;/groupId&gt;
  &lt;artifactId&gt;flink-connector-mysql-cdc&lt;/artifactId&gt;
  &lt;!-- the dependency is available only for stable releases. --&gt;
  &lt;version&gt;2.1.1&lt;/version&gt;
&lt;/dependency&gt;
</pre></div>
</div>
</section>
<section id="sql-client-jar">
<h3>SQL Client JAR<a class="headerlink" href="#sql-client-jar" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Download</span> <span class="pre">link</span> <span class="pre">is</span> <span class="pre">available</span> <span class="pre">only</span> <span class="pre">for</span> <span class="pre">stable</span> <span class="pre">releases.</span></code></p>
<p>Download <a class="reference external" href="https://repo1.maven.org/maven2/com/ververica/flink-sql-connector-mysql-cdc/2.1.1/flink-sql-connector-mysql-cdc-2.1.1.jar">flink-sql-connector-mysql-cdc-2.1.1.jar</a> and put it under <code class="docutils literal notranslate"><span class="pre">&lt;FLINK_HOME&gt;/lib/</span></code>.</p>
</section>
</section>
<section id="setup-mysql-server">
<h2>Setup MySQL server<a class="headerlink" href="#setup-mysql-server" title="Permalink to this headline">¶</a></h2>
<p>You have to define a MySQL user with appropriate permissions on all databases that the Debezium MySQL connector monitors.</p>
<ol class="simple">
<li><p>Create the MySQL user:</p></li>
</ol>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">CREATE</span> <span class="k">USER</span> <span class="s1">&#39;user&#39;</span><span class="o">@</span><span class="s1">&#39;localhost&#39;</span> <span class="n">IDENTIFIED</span> <span class="k">BY</span> <span class="s1">&#39;password&#39;</span><span class="p">;</span>
</pre></div>
</div>
<ol class="simple">
<li><p>Grant the required permissions to the user:</p></li>
</ol>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">GRANT</span> <span class="k">SELECT</span><span class="p">,</span> <span class="k">SHOW</span> <span class="n">DATABASES</span><span class="p">,</span> <span class="n">REPLICATION</span> <span class="n">SLAVE</span><span class="p">,</span> <span class="n">REPLICATION</span> <span class="n">CLIENT</span> <span class="k">ON</span> <span class="o">*</span><span class="p">.</span><span class="o">*</span> <span class="k">TO</span> <span class="s1">&#39;user&#39;</span> <span class="n">IDENTIFIED</span> <span class="k">BY</span> <span class="s1">&#39;password&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p><strong>Note:</strong> The RELOAD permissions is not required any more when <code class="docutils literal notranslate"><span class="pre">scan.incremental.snapshot.enabled</span></code> is enabled (enabled by default).</p>
<ol class="simple">
<li><p>Finalize the user’s permissions:</p></li>
</ol>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">mysql</span><span class="o">&gt;</span> <span class="n">FLUSH</span> <span class="k">PRIVILEGES</span><span class="p">;</span>
</pre></div>
</div>
<p>See more about the <a class="reference external" href="https://debezium.io/documentation/reference/1.5/connectors/mysql.html#mysql-creating-user">permission explanation</a>.</p>
</section>
<section id="notes">
<h2>Notes<a class="headerlink" href="#notes" title="Permalink to this headline">¶</a></h2>
<section id="set-a-different-server-id-for-each-reader">
<h3>Set a different SERVER ID for each reader<a class="headerlink" href="#set-a-different-server-id-for-each-reader" title="Permalink to this headline">¶</a></h3>
<p>Every MySQL database client for reading binlog should have an unique id, called server id. MySQL server will use this id to maintain network connection and the binlog position. Therefore, if different jobs share a same server id, it may result to read from wrong binlog position.
Thus, it is recommended to set different server id for each reader via the <a class="reference external" href="https://ci.apache.org/projects/flink/flink-docs-release-1.11/dev/table/sql/hints.html">SQL Hints</a>,
e.g.  assuming the source parallelism is 4, then we can use <code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">*</span> <span class="pre">FROM</span> <span class="pre">source_table</span> <span class="pre">/*+</span> <span class="pre">OPTIONS('server-id'='5401-5404')</span> <span class="pre">*/</span> <span class="pre">;</span></code> to assign unique server id for each of the 4 source readers.</p>
</section>
<section id="setting-up-mysql-session-timeouts">
<h3>Setting up MySQL session timeouts<a class="headerlink" href="#setting-up-mysql-session-timeouts" title="Permalink to this headline">¶</a></h3>
<p>When an initial consistent snapshot is made for large databases, your established connection could timeout while the tables are being read. You can prevent this behavior by configuring interactive_timeout and wait_timeout in your MySQL configuration file.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">interactive_timeout</span></code>: The number of seconds the server waits for activity on an interactive connection before closing it. See <a class="reference external" href="https://dev.mysql.com/doc/refman/8.0/en/server-system-variables.html#sysvar_interactive_timeout">MySQL documentations</a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wait_timeout</span></code>: The number of seconds the server waits for activity on a noninteractive connection before closing it. See <a class="reference external" href="https://dev.mysql.com/doc/refman/8.0/en/server-system-variables.html#sysvar_wait_timeout">MySQL documentations</a>.</p></li>
</ul>
</section>
</section>
<section id="how-to-create-a-mysql-cdc-table">
<h2>How to create a MySQL CDC table<a class="headerlink" href="#how-to-create-a-mysql-cdc-table" title="Permalink to this headline">¶</a></h2>
<p>The MySQL CDC table can be defined as following:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- checkpoint every 3000 milliseconds                       </span>
<span class="n">Flink</span> <span class="k">SQL</span><span class="o">&gt;</span> <span class="k">SET</span> <span class="s1">&#39;execution.checkpointing.interval&#39;</span> <span class="o">=</span> <span class="s1">&#39;3s&#39;</span><span class="p">;</span>   

<span class="c1">-- register a MySQL table &#39;orders&#39; in Flink SQL</span>
<span class="n">Flink</span> <span class="k">SQL</span><span class="o">&gt;</span> <span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">orders</span> <span class="p">(</span>
     <span class="n">order_id</span> <span class="nb">INT</span><span class="p">,</span>
     <span class="n">order_date</span> <span class="k">TIMESTAMP</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
     <span class="n">customer_name</span> <span class="n">STRING</span><span class="p">,</span>
     <span class="n">price</span> <span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
     <span class="n">product_id</span> <span class="nb">INT</span><span class="p">,</span>
     <span class="n">order_status</span> <span class="nb">BOOLEAN</span><span class="p">,</span>
     <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">(</span><span class="n">order_id</span><span class="p">)</span> <span class="k">NOT</span> <span class="n">ENFORCED</span>
     <span class="p">)</span> <span class="k">WITH</span> <span class="p">(</span>
     <span class="s1">&#39;connector&#39;</span> <span class="o">=</span> <span class="s1">&#39;mysql-cdc&#39;</span><span class="p">,</span>
     <span class="s1">&#39;hostname&#39;</span> <span class="o">=</span> <span class="s1">&#39;localhost&#39;</span><span class="p">,</span>
     <span class="s1">&#39;port&#39;</span> <span class="o">=</span> <span class="s1">&#39;3306&#39;</span><span class="p">,</span>
     <span class="s1">&#39;username&#39;</span> <span class="o">=</span> <span class="s1">&#39;root&#39;</span><span class="p">,</span>
     <span class="s1">&#39;password&#39;</span> <span class="o">=</span> <span class="s1">&#39;123456&#39;</span><span class="p">,</span>
     <span class="s1">&#39;database-name&#39;</span> <span class="o">=</span> <span class="s1">&#39;mydb&#39;</span><span class="p">,</span>
     <span class="s1">&#39;table-name&#39;</span> <span class="o">=</span> <span class="s1">&#39;orders&#39;</span><span class="p">);</span>
  
<span class="c1">-- read snapshot and binlogs from orders table</span>
<span class="n">Flink</span> <span class="k">SQL</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">orders</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="connector-options">
<h2>Connector Options<a class="headerlink" href="#connector-options" title="Permalink to this headline">¶</a></h2>
<div class="highlight">
<table class="colwidths-auto docutils">
    <thead>
      <tr>
        <th class="text-left" style="width: 10%">Option</th>
        <th class="text-left" style="width: 8%">Required</th>
        <th class="text-left" style="width: 7%">Default</th>
        <th class="text-left" style="width: 10%">Type</th>
        <th class="text-left" style="width: 65%">Description</th>
      </tr>
    </thead>
    <tbody>
    <tr>
      <td>connector</td>
      <td>required</td>
      <td style="word-wrap: break-word;">(none)</td>
      <td>String</td>
      <td>Specify what connector to use, here should be <code>'mysql-cdc'</code>.</td>
    </tr>
    <tr>
      <td>hostname</td>
      <td>required</td>
      <td style="word-wrap: break-word;">(none)</td>
      <td>String</td>
      <td>IP address or hostname of the MySQL database server.</td>
    </tr>
    <tr>
      <td>username</td>
      <td>required</td>
      <td style="word-wrap: break-word;">(none)</td>
      <td>String</td>
      <td>Name of the MySQL database to use when connecting to the MySQL database server.</td>
    </tr>
    <tr>
      <td>password</td>
      <td>required</td>
      <td style="word-wrap: break-word;">(none)</td>
      <td>String</td>
      <td>Password to use when connecting to the MySQL database server.</td>
    </tr>
    <tr>
      <td>database-name</td>
      <td>required</td>
      <td style="word-wrap: break-word;">(none)</td>
      <td>String</td>
      <td>Database name of the MySQL server to monitor. The database-name also supports regular expressions to monitor multiple tables matches the regular expression.</td>
    </tr> 
    <tr>
      <td>table-name</td>
      <td>required</td>
      <td style="word-wrap: break-word;">(none)</td>
      <td>String</td>
      <td>Table name of the MySQL database to monitor. The table-name also supports regular expressions to monitor multiple tables matches the regular expression.</td>
    </tr>
    <tr>
      <td>port</td>
      <td>optional</td>
      <td style="word-wrap: break-word;">3306</td>
      <td>Integer</td>
      <td>Integer port number of the MySQL database server.</td>
    </tr>
    <tr>
      <td>server-id</td>
      <td>optional</td>
      <td style="word-wrap: break-word;">(none)</td>
      <td>Integer</td>
      <td>A numeric ID or a numeric ID range of this database client, The numeric ID syntax is like '5400', 
          the numeric ID range syntax is like '5400-5408', The numeric ID range syntax is recommended when 'scan.incremental.snapshot.enabled' enabled.
          Every ID must be unique across all currently-running database processes in the MySQL cluster. This connector joins the MySQL cluster
          as another server (with this unique ID) so it can read the binlog. By default, a random number is generated between 5400 and 6400,
          though we recommend setting an explicit value.
      </td>
    </tr>
    <tr>
          <td>scan.incremental.snapshot.enabled</td>
          <td>optional</td>
          <td style="word-wrap: break-word;">true</td>
          <td>Boolean</td>
          <td>Incremental snapshot is a new mechanism to read snapshot of a table. Compared to the old snapshot mechanism,
              the incremental snapshot has many advantages, including:
                (1) source can be parallel during snapshot reading, 
                (2) source can perform checkpoints in the chunk granularity during snapshot reading, 
                (3) source doesn't need to acquire global read lock (FLUSH TABLES WITH READ LOCK) before snapshot reading.
              If you would like the source run in parallel, each parallel reader should have an unique server id, so 
              the 'server-id' must be a range like '5400-6400', and the range must be larger than the parallelism.
              Please see <a href="#incremental-snapshot-reading ">Incremental Snapshot Reading</a>section for more detailed information.
          </td>
    </tr>
    <tr>
          <td>scan.incremental.snapshot.chunk.size</td>
          <td>optional</td>
          <td style="word-wrap: break-word;">8096</td>
          <td>Integer</td>
          <td>The chunk size (number of rows) of table snapshot, captured tables are split into multiple chunks when read the snapshot of table.</td>
    </tr>
    <tr>
          <td>scan.snapshot.fetch.size</td>
          <td>optional</td>
          <td style="word-wrap: break-word;">1024</td>
          <td>Integer</td>
          <td>The maximum fetch size for per poll when read table snapshot.</td>
    </tr>
    <tr>
      <td>scan.startup.mode</td>
      <td>optional</td>
      <td style="word-wrap: break-word;">initial</td>
      <td>String</td>
      <td>Optional startup mode for MySQL CDC consumer, valid enumerations are "initial"
           and "latest-offset". 
           Please see <a href="#startup-reading-position">Startup Reading Position</a>section for more detailed information.</td>
    </tr> 
    <tr>
      <td>server-time-zone</td>
      <td>optional</td>
      <td style="word-wrap: break-word;">UTC</td>
      <td>String</td>
      <td>The session time zone in database server, e.g. "Asia/Shanghai". 
          It controls how the TIMESTAMP type in MYSQL converted to STRING.
          See more <a href="https://debezium.io/documentation/reference/1.5/connectors/mysql.html#mysql-temporal-types">here</a>.</td>
    </tr>
    <tr>
      <td>debezium.min.row.
      count.to.stream.result</td>
      <td>optional</td>
      <td style="word-wrap: break-word;">1000</td>
      <td>Integer</td>
      <td>	
During a snapshot operation, the connector will query each included table to produce a read event for all rows in that table. This parameter determines whether the MySQL connection will pull all results for a table into memory (which is fast but requires large amounts of memory), or whether the results will instead be streamed (can be slower, but will work for very large tables). The value specifies the minimum number of rows a table must contain before the connector will stream results, and defaults to 1,000. Set this parameter to '0' to skip all table size checks and always stream all results during a snapshot.</td>
    </tr>
    <tr>
          <td>connect.timeout</td>
          <td>optional</td>
          <td style="word-wrap: break-word;">30s</td>
          <td>Duration</td>
          <td>The maximum time that the connector should wait after trying to connect to the MySQL database server before timing out.</td>
    </tr>    
    <tr>
          <td>connect.max-retries</td>
          <td>optional</td>
          <td style="word-wrap: break-word;">3</td>
          <td>Integer</td>
          <td>The max retry times that the connector should retry to build MySQL database server connection.</td>
    </tr>
    <tr>
          <td>connection.pool.size</td>
          <td>optional</td>
          <td style="word-wrap: break-word;">20</td>
          <td>Integer</td>
          <td>The connection pool size.</td>
    </tr>
    <tr>
      <td>debezium.*</td>
      <td>optional</td>
      <td style="word-wrap: break-word;">(none)</td>
      <td>String</td>
      <td>Pass-through Debezium's properties to Debezium Embedded Engine which is used to capture data changes from MySQL server.
          For example: <code>'debezium.snapshot.mode' = 'never'</code>.
          See more about the <a href="https://debezium.io/documentation/reference/1.5/connectors/mysql.html#mysql-connector-properties">Debezium's MySQL Connector properties</a></td> 
    </tr>
    </tbody>
</table>
</div>
</section>
<section id="available-metadata">
<h2>Available Metadata<a class="headerlink" href="#available-metadata" title="Permalink to this headline">¶</a></h2>
<p>The following format metadata can be exposed as read-only (VIRTUAL) columns in a table definition.</p>
<table class="colwidths-auto docutils">
  <thead>
     <tr>
       <th class="text-left" style="width: 15%">Key</th>
       <th class="text-left" style="width: 30%">DataType</th>
       <th class="text-left" style="width: 55%">Description</th>
     </tr>
  </thead>
  <tbody>
    <tr>
      <td>table_name</td>
      <td>STRING NOT NULL</td>
      <td>Name of the table that contain the row.</td>
    </tr>
    <tr>
      <td>database_name</td>
      <td>STRING NOT NULL</td>
      <td>Name of the database that contain the row.</td>
    </tr>
    <tr>
      <td>op_ts</td>
      <td>TIMESTAMP_LTZ(3) NOT NULL</td>
      <td>It indicates the time that the change was made in the database. <br>If the record is read from snapshot of the table instead of the binlog, the value is always 0.</td>
    </tr>
  </tbody>
</table>
<p>The extended CREATE TABLE example demonstrates the syntax for exposing these metadata fields:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">products</span> <span class="p">(</span>
    <span class="n">db_name</span> <span class="n">STRING</span> <span class="n">METADATA</span> <span class="k">FROM</span> <span class="s1">&#39;database_name&#39;</span> <span class="n">VIRTUAL</span><span class="p">,</span>
    <span class="k">table_name</span> <span class="n">STRING</span> <span class="n">METADATA</span>  <span class="k">FROM</span> <span class="s1">&#39;table_name&#39;</span> <span class="n">VIRTUAL</span><span class="p">,</span>
    <span class="n">operation_ts</span> <span class="n">TIMESTAMP_LTZ</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">METADATA</span> <span class="k">FROM</span> <span class="s1">&#39;op_ts&#39;</span> <span class="n">VIRTUAL</span><span class="p">,</span>
    <span class="n">order_id</span> <span class="nb">INT</span><span class="p">,</span>
    <span class="n">order_date</span> <span class="k">TIMESTAMP</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
    <span class="n">customer_name</span> <span class="n">STRING</span><span class="p">,</span>
    <span class="n">price</span> <span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
    <span class="n">product_id</span> <span class="nb">INT</span><span class="p">,</span>
    <span class="n">order_status</span> <span class="nb">BOOLEAN</span><span class="p">,</span>
    <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">(</span><span class="n">order_id</span><span class="p">)</span> <span class="k">NOT</span> <span class="n">ENFORCED</span>
<span class="p">)</span> <span class="k">WITH</span> <span class="p">(</span>
    <span class="s1">&#39;connector&#39;</span> <span class="o">=</span> <span class="s1">&#39;mysql-cdc&#39;</span><span class="p">,</span>
    <span class="s1">&#39;hostname&#39;</span> <span class="o">=</span> <span class="s1">&#39;localhost&#39;</span><span class="p">,</span>
    <span class="s1">&#39;port&#39;</span> <span class="o">=</span> <span class="s1">&#39;3306&#39;</span><span class="p">,</span>
    <span class="s1">&#39;username&#39;</span> <span class="o">=</span> <span class="s1">&#39;root&#39;</span><span class="p">,</span>
    <span class="s1">&#39;password&#39;</span> <span class="o">=</span> <span class="s1">&#39;123456&#39;</span><span class="p">,</span>
    <span class="s1">&#39;database-name&#39;</span> <span class="o">=</span> <span class="s1">&#39;mydb&#39;</span><span class="p">,</span>
    <span class="s1">&#39;table-name&#39;</span> <span class="o">=</span> <span class="s1">&#39;orders&#39;</span>
<span class="p">);</span>
</pre></div>
</div>
</section>
<section id="features">
<h2>Features<a class="headerlink" href="#features" title="Permalink to this headline">¶</a></h2>
<section id="incremental-snapshot-reading">
<h3>Incremental Snapshot Reading<a class="headerlink" href="#incremental-snapshot-reading" title="Permalink to this headline">¶</a></h3>
<p>Incremental snapshot reading is a new mechanism to read snapshot of a table. Compared to the old snapshot mechanism, the incremental snapshot has many advantages, including:</p>
<ul class="simple">
<li><p>(1) MySQL CDC Source can be parallel during snapshot reading</p></li>
<li><p>(2) MySQL CDC Source can perform checkpoints in the chunk granularity during snapshot reading</p></li>
<li><p>(3) MySQL CDC Source doesn’t need to acquire global read lock (FLUSH TABLES WITH READ LOCK) before snapshot reading</p></li>
</ul>
<p>If you would like the source run in parallel, each parallel reader should have an unique server id, so the ‘server-id’ must be a range like ‘5400-6400’,
and the range must be larger than the parallelism.</p>
<p>During the incremental snapshot reading, the MySQL CDC Source firstly splits snapshot chunks (splits) by primary key of table,
and then MySQL CDC Source assigns the chunks to multiple readers to read the data of snapshot chunk.</p>
<section id="controlling-parallelism">
<h4>Controlling Parallelism<a class="headerlink" href="#controlling-parallelism" title="Permalink to this headline">¶</a></h4>
<p>Incremental snapshot reading provides the ability to read snapshot data parallelly.
You can control the source parallelism by setting the job parallelism <code class="docutils literal notranslate"><span class="pre">parallelism.default</span></code>. For example, in SQL CLI:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">Flink</span> <span class="k">SQL</span><span class="o">&gt;</span> <span class="k">SET</span> <span class="s1">&#39;parallelism.default&#39;</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="checkpoint">
<h4>Checkpoint<a class="headerlink" href="#checkpoint" title="Permalink to this headline">¶</a></h4>
<p>Incremental snapshot reading provides the ability to perform checkpoint in chunk level. It resolves the checkpoint timeout problem in previous version with old snapshot reading mechanism.</p>
</section>
<section id="lock-free">
<h4>Lock-free<a class="headerlink" href="#lock-free" title="Permalink to this headline">¶</a></h4>
<p>The MySQL CDC source use <strong>incremental snapshot algorithm</strong>, which avoid acquiring global read lock (FLUSH TABLES WITH READ LOCK) and thus doesn’t need <code class="docutils literal notranslate"><span class="pre">RELOAD</span></code> permission.</p>
</section>
<section id="mysql-high-availability-support">
<h4>MySQL High Availability Support<a class="headerlink" href="#mysql-high-availability-support" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">mysql-cdc</span></code> connector offers high availability of MySQL high available cluster by using the <a class="reference external" href="https://dev.mysql.com/doc/refman/5.7/en/replication-gtids-concepts.html">GTID</a> information. To obtain the high availability, the MySQL cluster need enable the GTID mode, the GTID mode in your mysql config file should contain following settings:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">gtid_mode = on</span>
<span class="l l-Scalar l-Scalar-Plain">enforce_gtid_consistency = on</span>
</pre></div>
</div>
<p>If the monitored MySQL server address contains slave instance, you need set following settings to the MySQL conf file. The setting <code class="docutils literal notranslate"><span class="pre">log-slave-updates</span> <span class="pre">=</span> <span class="pre">1</span></code> enables the slave instance to also write the data that synchronized from master to its binlog, this makes sure that the <code class="docutils literal notranslate"><span class="pre">mysql-cdc</span></code> connector can consume entire data from the slave instance.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">gtid_mode = on</span>
<span class="l l-Scalar l-Scalar-Plain">enforce_gtid_consistency = on</span>
<span class="l l-Scalar l-Scalar-Plain">log-slave-updates = 1</span>
</pre></div>
</div>
<p>After the server you monitored fails in MySQL cluster, you only need to change the monitored server address to other available server and then restart the job from the latest checkpoint/savepoint, the job will restore from the checkpoint/savepoint and won’t miss any records.</p>
<p>It’s recommended to configure a DNS(Domain Name Service) or VIP(Virtual IP Address) for your MySQL cluster, using the DNS or VIP address for <code class="docutils literal notranslate"><span class="pre">mysql-cdc</span></code> connector, the DNS or VIP would automatically route the network request to the active MySQL server. In this way, you don’t need to modify the address and restart your pipeline anymore.</p>
</section>
<section id="how-incremental-snapshot-reading-works">
<h4>How Incremental Snapshot Reading works<a class="headerlink" href="#how-incremental-snapshot-reading-works" title="Permalink to this headline">¶</a></h4>
<p>When the MySQL CDC source is started, it reads snapshot of table parallelly and then reads binlog of table with single parallelism.</p>
<p>In snapshot phase, the snapshot is cut into multiple snapshot chunks according to primary key of table and the size of table rows.
Snapshot chunks is assigned to multiple snapshot readers. Each snapshot reader reads its received chunks with <a class="reference external" href="#snapshot-chunk-reading">chunk reading algorithm</a> and send the read data to downstream.
The source manages the process status (finished or not) of chunks, thus the source of snapshot phase can support checkpoint in chunk level.
If a failure happens, the source can be restored and continue to read chunks from last finished chunks.</p>
<p>After all snapshot chunks finished, the source will continue to read binlog in a single task.
In order to guarantee the global data order of snapshot records and binlog records, binlog reader will start to read data
until there is a complete checkpoint after snapshot chunks finished to make sure all snapshot data has been consumed by downstream.
The binlog reader tracks the consumed binlog position in state, thus source of binlog phase can support checkpoint in row level.</p>
<p>Flink performs checkpoints for the source periodically, in case of failover, the job will restart and restore from the last successful checkpoint state and guarantees the exactly once semantic.</p>
<section id="snapshot-chunk-splitting">
<h5>Snapshot Chunk Splitting<a class="headerlink" href="#snapshot-chunk-splitting" title="Permalink to this headline">¶</a></h5>
<p>When performing incremental snapshot reading, MySQL CDC source need a criterion which used to split the table.
MySQL CDC Source use a splitting column to split the table to multiple splits (chunks). By default, MySQL CDC source will identify the primary key column of the table and use the first column in primary key as the splitting column.
If there is no primary key in the table, incremental snapshot reading will fail and you can disable <code class="docutils literal notranslate"><span class="pre">scan.incremental.snapshot.enabled</span></code> to fallback to old snapshot reading mechanism.</p>
<p>For numeric and auto incremental splitting column, MySQL CDC Source efficiently splits chunks by fixed step length.
For example, if you had a table with a primary key column of <code class="docutils literal notranslate"><span class="pre">id</span></code> which is auto-incremental BIGINT type, the minimum value was <code class="docutils literal notranslate"><span class="pre">0</span></code> and maximum value was <code class="docutils literal notranslate"><span class="pre">100</span></code>,
and the table option <code class="docutils literal notranslate"><span class="pre">scan.incremental.snapshot.chunk.size</span></code> value is <code class="docutils literal notranslate"><span class="pre">25</span></code>, the table would be split into following chunks:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> (-∞, 25),
 [25, 50),
 [50, 75),
 [75, 100),
 [100, +∞)
</pre></div>
</div>
<p>For other primary key column type, MySQL CDC Source executes the statement in the form of <code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">MAX(STR_ID)</span> <span class="pre">AS</span> <span class="pre">chunk_high</span> <span class="pre">FROM</span> <span class="pre">(SELECT</span> <span class="pre">*</span> <span class="pre">FROM</span> <span class="pre">TestTable</span> <span class="pre">WHERE</span> <span class="pre">STR_ID</span> <span class="pre">&gt;</span> <span class="pre">'uuid-001'</span> <span class="pre">limit</span> <span class="pre">25)</span></code> to get the low and high value for each chunk,
the splitting chunks set would be like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(-∞, &#39;uuid-001&#39;),
[&#39;uuid-001&#39;, &#39;uuid-009&#39;),
[&#39;uuid-009&#39;, &#39;uuid-abc&#39;),
[&#39;uuid-abc&#39;, &#39;uuid-def&#39;),
[uuid-def, +∞).
</pre></div>
</div>
</section>
<section id="chunk-reading-algorithm">
<h5>Chunk Reading Algorithm<a class="headerlink" href="#chunk-reading-algorithm" title="Permalink to this headline">¶</a></h5>
<p>For above example <code class="docutils literal notranslate"><span class="pre">MyTable</span></code>, if the MySQL CDC Source parallelism was set to 4, MySQL CDC Source would run 4 readers which each executes <strong>Offset Signal Algorithm</strong> to
get a final consistent output of the snapshot chunk. The <strong>Offset Signal Algorithm</strong> simply describes as following:</p>
<ul class="simple">
<li><p>(1) Record current binlog position as <code class="docutils literal notranslate"><span class="pre">LOW</span></code> offset</p></li>
<li><p>(2) Read and buffer the snapshot chunk records by executing statement <code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">*</span> <span class="pre">FROM</span> <span class="pre">MyTable</span> <span class="pre">WHERE</span> <span class="pre">id</span> <span class="pre">&gt;</span> <span class="pre">chunk_low</span> <span class="pre">AND</span> <span class="pre">id</span> <span class="pre">&lt;=</span> <span class="pre">chunk_high</span></code></p></li>
<li><p>(3) Record current binlog position as <code class="docutils literal notranslate"><span class="pre">HIGH</span></code> offset</p></li>
<li><p>(4) Read the binlog records that belong to the snapshot chunk from <code class="docutils literal notranslate"><span class="pre">LOW</span></code> offset to <code class="docutils literal notranslate"><span class="pre">HIGH</span></code> offset</p></li>
<li><p>(5) Upsert the read binlog records into the buffered chunk records, and emit all records in the buffer as final output (all as INSERT records) of the snapshot chunk</p></li>
<li><p>(6) Continue to read and emit binlog records belong to the chunk after the <code class="docutils literal notranslate"><span class="pre">HIGH</span></code> offset in <em>single binlog reader</em>.</p></li>
</ul>
<p>The algorithm is inspired by <a class="reference external" href="https://arxiv.org/pdf/2010.12597v1.pdf">DBLog Paper</a>, please refer it for more detail.</p>
<p><strong>Note:</strong> If the actual values for the primary key are not uniformly distributed across its range, this may lead to unbalanced tasks when incremental snapshot read.</p>
</section>
</section>
</section>
<section id="exactly-once-processing">
<h3>Exactly-Once Processing<a class="headerlink" href="#exactly-once-processing" title="Permalink to this headline">¶</a></h3>
<p>The MySQL CDC connector is a Flink Source connector which will read table snapshot chunks first and then continues to read binlog,
both snapshot phase and binlog phase, MySQL CDC connector read with <strong>exactly-once processing</strong> even failures happen.</p>
</section>
<section id="startup-reading-position">
<h3>Startup Reading Position<a class="headerlink" href="#startup-reading-position" title="Permalink to this headline">¶</a></h3>
<p>The config option <code class="docutils literal notranslate"><span class="pre">scan.startup.mode</span></code> specifies the startup mode for MySQL CDC consumer. The valid enumerations are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">initial</span></code> (default): Performs an initial snapshot on the monitored database tables upon first startup, and continue to read the latest binlog.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">latest-offset</span></code>: Never to perform snapshot on the monitored database tables upon first startup, just read from
the end of the binlog which means only have the changes since the connector was started.</p></li>
</ul>
<p><em>Note: the mechanism of <code class="docutils literal notranslate"><span class="pre">scan.startup.mode</span></code> option relying on Debezium’s <code class="docutils literal notranslate"><span class="pre">snapshot.mode</span></code> configuration. So please do not using them together. If you speicifying both <code class="docutils literal notranslate"><span class="pre">scan.startup.mode</span></code> and <code class="docutils literal notranslate"><span class="pre">debezium.snapshot.mode</span></code> options in the table DDL, it may make <code class="docutils literal notranslate"><span class="pre">scan.startup.mode</span></code> doesn’t work.</em></p>
</section>
<section id="datastream-source">
<h3>DataStream Source<a class="headerlink" href="#datastream-source" title="Permalink to this headline">¶</a></h3>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.apache.flink.api.common.eventtime.WatermarkStrategy</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.apache.flink.streaming.api.environment.StreamExecutionEnvironment</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.ververica.cdc.debezium.JsonDebeziumDeserializationSchema</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.ververica.cdc.connectors.mysql.source.MySqlSource</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MySqlSourceExample</span> <span class="p">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="p">{</span>
    <span class="n">MySqlSource</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">mySqlSource</span> <span class="o">=</span> <span class="n">MySqlSource</span><span class="p">.</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="n">builder</span><span class="p">()</span>
        <span class="p">.</span><span class="na">hostname</span><span class="p">(</span><span class="s">&quot;yourHostname&quot;</span><span class="p">)</span>
        <span class="p">.</span><span class="na">port</span><span class="p">(</span><span class="n">yourPort</span><span class="p">)</span>
        <span class="p">.</span><span class="na">databaseList</span><span class="p">(</span><span class="s">&quot;yourDatabaseName&quot;</span><span class="p">)</span> <span class="c1">// set captured database</span>
        <span class="p">.</span><span class="na">tableList</span><span class="p">(</span><span class="s">&quot;yourDatabaseName.yourTableName&quot;</span><span class="p">)</span> <span class="c1">// set captured table</span>
        <span class="p">.</span><span class="na">username</span><span class="p">(</span><span class="s">&quot;yourUsername&quot;</span><span class="p">)</span>
        <span class="p">.</span><span class="na">password</span><span class="p">(</span><span class="s">&quot;yourPassword&quot;</span><span class="p">)</span>
        <span class="p">.</span><span class="na">deserializer</span><span class="p">(</span><span class="k">new</span> <span class="n">JsonDebeziumDeserializationSchema</span><span class="p">())</span> <span class="c1">// converts SourceRecord to JSON String</span>
        <span class="p">.</span><span class="na">build</span><span class="p">();</span>

    <span class="n">StreamExecutionEnvironment</span> <span class="n">env</span> <span class="o">=</span> <span class="n">StreamExecutionEnvironment</span><span class="p">.</span><span class="na">getExecutionEnvironment</span><span class="p">();</span>

    <span class="c1">// enable checkpoint</span>
    <span class="n">env</span><span class="p">.</span><span class="na">enableCheckpointing</span><span class="p">(</span><span class="mi">3000</span><span class="p">);</span>

    <span class="n">env</span>
      <span class="p">.</span><span class="na">fromSource</span><span class="p">(</span><span class="n">mySqlSource</span><span class="p">,</span> <span class="n">WatermarkStrategy</span><span class="p">.</span><span class="na">noWatermarks</span><span class="p">(),</span> <span class="s">&quot;MySQL Source&quot;</span><span class="p">)</span>
      <span class="c1">// set 4 parallel source tasks</span>
      <span class="p">.</span><span class="na">setParallelism</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
      <span class="p">.</span><span class="na">print</span><span class="p">().</span><span class="na">setParallelism</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="c1">// use parallelism 1 for sink to keep message ordering</span>

    <span class="n">env</span><span class="p">.</span><span class="na">execute</span><span class="p">(</span><span class="s">&quot;Print MySQL Snapshot + Binlog&quot;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Note:</strong> Please refer <a class="reference external" href="../about.html#deserialization">Deserialization</a> for more details about the JSON deserialization.</p>
</section>
</section>
<section id="data-type-mapping">
<h2>Data Type Mapping<a class="headerlink" href="#data-type-mapping" title="Permalink to this headline">¶</a></h2>
<div class="wy-table-responsive">
<table class="colwidths-auto docutils">
    <thead>
      <tr>
        <th class="text-left">MySQL type<a href="https://dev.mysql.com/doc/man/8.0/en/data-types.html"></a></th>
        <th class="text-left">Flink SQL type<a href="{% link dev/table/types.md %}"></a></th>
        <th class="text-left">NOTE</th>
      </tr>
    </thead>
    <tbody>
    <tr>
      <td>TINYINT</td>
      <td>TINYINT</td>
      <td></td>
    </tr>
    <tr>
      <td>
        SMALLINT<br>
        TINYINT UNSIGNED</td>
      <td>SMALLINT</td>
      <td></td>
    </tr>
    <tr>
      <td>
        INT<br>
        MEDIUMINT<br>
        SMALLINT UNSIGNED</td>
      <td>INT</td>
      <td></td>
    </tr>
    <tr>
      <td>
        BIGINT<br>
        INT UNSIGNED</td>
      <td>BIGINT</td>
      <td></td>
    </tr>
   <tr>
      <td>BIGINT UNSIGNED</td>
      <td>DECIMAL(20, 0)</td>
      <td></td>
    </tr>
    <tr>
      <td>
        REAL<br>
        FLOAT<br>
        </td>
      <td>FLOAT</td>
      <td></td>
    </tr>
    <tr>
      <td>
        DOUBLE
      </td>
      <td>DOUBLE</td>
      <td></td>
    </tr>
    <tr>
      <td>
        NUMERIC(p, s)<br>
        DECIMAL(p, s)<br>
        where p <= 38<br>
      </td>
      <td>DECIMAL(p, s)</td>
      <td></td>
    </tr>
    <tr>
      <td>
        NUMERIC(p, s)<br>
        DECIMAL(p, s)<br>
        where 38 < p <= 65<br>
      </td>
      <td>STRING</td>
      <td>The precision for DECIMAL data type is up to 65 in MySQL, but the precision for DECIMAL is limited to 38 in Flink.
  So if you define a decimal column whose precision is greater than 38, you should map it to STRING to avoid precision loss.</td>
    </tr>
    <tr>
      <td>
        BOOLEAN<br>
        TINYINT(1)<br>
        BIT(1)
        </td>
      <td>BOOLEAN</td>
      <td></td>
    </tr>
    <tr>
      <td>DATE</td>
      <td>DATE</td>
      <td></td>
    </tr>
    <tr>
      <td>TIME [(p)]</td>
      <td>TIME [(p)]</td>
      <td></td>
    </tr>
    <tr>
      <td>TIMESTAMP [(p)]<br>
        DATETIME [(p)]
      </td>
      <td>TIMESTAMP [(p)]
      </td>
      <td></td>
    </tr>
    <tr>
      <td>
        CHAR(n)
      </td>
      <td>CHAR(n)</td>
      <td></td>
    </tr>
    <tr>
      <td>
        VARCHAR(n)
      </td>
      <td>VARCHAR(n)</td>
      <td></td>
    </tr>
    <tr>
      <td>
        BIT(n)
      </td>
      <td>BINARY(⌈n/8⌉)</td>
      <td></td>
    </tr>
    <tr>
      <td>
        BINARY(n)
      </td>
      <td>BINARY(n)</td>
      <td></td>
    </tr>
    <tr>
      <td>
        VARBINARY(N)
      </td>
      <td>VARBINARY(N)</td>
      <td></td>
    </tr>
    <tr>
      <td>
        TINYTEXT<br>
        TEXT<br>
        MEDIUMTEXT<br>
        LONGTEXT<br>
      </td>
      <td>STRING</td>
      <td></td>
    </tr>
    <tr>
      <td>
        TINYBLOB<br>
        BLOB<br>
        MEDIUMBLOB<br>
        LONGBLOB<br>
      </td>
      <td>BYTES</td>
      <td>Currently, for BLOB data type in MySQL, only the blob whose length isn't greater than 2,147,483,647(2 ** 31 - 1) is supported. </td>
    </tr>
    <tr>
      <td>
        YEAR
      </td>
      <td>INT</td>
      <td></td>
    </tr>
    <tr>
      <td>
        ENUM
      </td>
      <td>STRING</td>
      <td></td>
    </tr>
    <tr>
      <td>
        JSON
      </td>
      <td>STRING</td>
      <td>The JSON data type  will be converted into STRING with JSON format in Flink.</td>
    </tr>
    <tr>
      <td>
        SET
      </td>
      <td>ARRAY&lt;STRING&gt;</td>
      <td>As the SET data type in MySQL is a string object that can have zero or more values, 
          it should always be mapped to an array of string
      </td>
    </tr>
    <tr>
      <td>
       GEOMETRY<br>
       POINT<br>
       LINESTRING<br>
       POLYGON<br>
       MULTIPOINT<br>
       MULTILINESTRING<br>
       MULTIPOLYGON<br>
       GEOMETRYCOLLECTION<br>
      </td>
      <td>
        STRING
      </td>
      <td>
      The spatial data types in MySQL will be converted into STRING with a fixed Json format.
      Please see <a href="#mysql-spatial-data-types-mapping ">MySQL Spatial Data Types Mapping</a> section for more detailed information.
      </td>
    </tr>
    </tbody>
</table>
</div>
<section id="mysql-spatial-data-types-mapping">
<h3>MySQL Spatial Data Types Mapping<a class="headerlink" href="#mysql-spatial-data-types-mapping" title="Permalink to this headline">¶</a></h3>
<p>The spatial data types except for <code class="docutils literal notranslate"><span class="pre">GEOMETRYCOLLECTION</span></code> in MySQL will be converted into Json String with a fixed format like:<br></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nt">&quot;srid&quot;</span><span class="p">:</span> <span class="mi">0</span> <span class="p">,</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;xxx&quot;</span><span class="p">,</span> <span class="nt">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]}</span>
</pre></div>
</div>
<p>The field <code class="docutils literal notranslate"><span class="pre">srid</span></code> identifies the SRS in which the geometry is defined, SRID 0 is the default for new geometry values if no SRID is specified.
As only MySQL 8+ support to specific SRID when define spatial data type, the field <code class="docutils literal notranslate"><span class="pre">srid</span></code> will always be 0 in MySQL with a lower version.</p>
<p>The field <code class="docutils literal notranslate"><span class="pre">type</span></code> identifies the spatial data type, such as <code class="docutils literal notranslate"><span class="pre">POINT</span></code>/<code class="docutils literal notranslate"><span class="pre">LINESTRING</span></code>/<code class="docutils literal notranslate"><span class="pre">POLYGON</span></code>.</p>
<p>The field <code class="docutils literal notranslate"><span class="pre">coordinates</span></code> represents the <code class="docutils literal notranslate"><span class="pre">coordinates</span></code> of the spatial data.</p>
<p>For <code class="docutils literal notranslate"><span class="pre">GEOMETRYCOLLECTION</span></code>, it will be converted into Json String with a fixed format like:<br></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nt">&quot;srid&quot;</span><span class="p">:</span> <span class="mi">0</span> <span class="p">,</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;GeometryCollection&quot;</span><span class="p">,</span> <span class="nt">&quot;geometries&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;Point&quot;</span><span class="p">,</span><span class="nt">&quot;coordinates&quot;</span><span class="p">:[</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">]}]}</span>
</pre></div>
</div>
<p>The field <code class="docutils literal notranslate"><span class="pre">geometries</span></code> is an array contains all spatial data.</p>
<p>The example for different spatial data types mapping is as follows:</p>
<div class="wy-table-responsive">
<table class="colwidths-auto docutils">
    <thead>
      <tr>
        <th class="text-left">Spatial data in MySQL</th>
        <th class="text-left">Json String converted in Flink</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>POINT(1 1)</td>
        <td>{"coordinates":[1,1],"type":"Point","srid":0}</td>
      </tr>
      <tr>
        <td>LINESTRING(3 0, 3 3, 3 5)</td>
        <td>{"coordinates":[[3,0],[3,3],[3,5]],"type":"LineString","srid":0}</td>
      </tr>
      <tr>
        <td>POLYGON((1 1, 2 1, 2 2,  1 2, 1 1))</td>
        <td>{"coordinates":[[[1,1],[2,1],[2,2],[1,2],[1,1]]],"type":"Polygon","srid":0}</td>
      </tr>
      <tr>
        <td>MULTIPOINT((1 1),(2 2))</td>
        <td>{"coordinates":[[1,1],[2,2]],"type":"MultiPoint","srid":0}</td>
      </tr>
      <tr>
        <td>MultiLineString((1 1,2 2,3 3),(4 4,5 5))</td>
        <td>{"coordinates":[[[1,1],[2,2],[3,3]],[[4,4],[5,5]]],"type":"MultiLineString","srid":0}</td>
      </tr>
      <tr>
        <td>MULTIPOLYGON(((0 0, 10 0, 10 10, 0 10, 0 0)), ((5 5, 7 5, 7 7, 5 7, 5 5)))</td>
        <td>{"coordinates":[[[[0,0],[10,0],[10,10],[0,10],[0,0]]],[[[5,5],[7,5],[7,7],[5,7],[5,5]]]],"type":"MultiPolygon","srid":0}</td>
      </tr>
      <tr>
        <td>GEOMETRYCOLLECTION(POINT(10 10), POINT(30 30), LINESTRING(15 15, 20 20))</td>
        <td>{"geometries":[{"type":"Point","coordinates":[10,10]},{"type":"Point","coordinates":[30,30]},{"type":"LineString","coordinates":[[15,15],[20,20]]}],"type":"GeometryCollection","srid":0}</td>
      </tr>
    </tbody>
</table>
</div>
</section>
</section>
<section id="faq">
<h2>FAQ<a class="headerlink" href="#faq" title="Permalink to this headline">¶</a></h2>
<section id="q1-how-to-skip-snapshot-and-only-read-from-binlog">
<h3>Q1: How to skip snapshot and only read from binlog?<a class="headerlink" href="#q1-how-to-skip-snapshot-and-only-read-from-binlog" title="Permalink to this headline">¶</a></h3>
<p>Please see <a class="reference external" href="#startup-reading-position">Startup Reading Position</a> section.</p>
</section>
<section id="q2-how-to-read-a-shared-database-that-contains-multiple-tables-e-g-user-00-user-01-user-99">
<h3>Q2: How to read a shared database that contains multiple tables, e.g. user_00, user_01, …, user_99 ?<a class="headerlink" href="#q2-how-to-read-a-shared-database-that-contains-multiple-tables-e-g-user-00-user-01-user-99" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">table-name</span></code> option supports regular expressions to monitor multiple tables matches the regular expression. So you can set <code class="docutils literal notranslate"><span class="pre">table-name</span></code> to <code class="docutils literal notranslate"><span class="pre">user_.*</span></code> to monitor all the <code class="docutils literal notranslate"><span class="pre">user_</span></code> prefix tables. The same to the <code class="docutils literal notranslate"><span class="pre">database-name</span></code> option. Note that the shared table should be in the same schema.</p>
</section>
<section id="q3-connectexception-received-dml-for-processing-binlog-probably-contains-events-generated-with-statement-or-mixed-based-replication-format">
<h3>Q3: ConnectException: Received DML ‘…’ for processing, binlog probably contains events generated with statement or mixed based replication format<a class="headerlink" href="#q3-connectexception-received-dml-for-processing-binlog-probably-contains-events-generated-with-statement-or-mixed-based-replication-format" title="Permalink to this headline">¶</a></h3>
<p>If there is above exception, please check <code class="docutils literal notranslate"><span class="pre">binlog_format</span></code> is <code class="docutils literal notranslate"><span class="pre">ROW</span></code>, you can check this by running <code class="docutils literal notranslate"><span class="pre">show</span> <span class="pre">variables</span> <span class="pre">like</span> <span class="pre">'%binlog_format%'</span></code> in MySQL client. Please note that even if the <code class="docutils literal notranslate"><span class="pre">binlog_format</span></code> configuration of your database is <code class="docutils literal notranslate"><span class="pre">ROW</span></code>, this configuration can be changed by other sessions, for example, <code class="docutils literal notranslate"><span class="pre">SET</span> <span class="pre">SESSION</span> <span class="pre">binlog_format='MIXED';</span> <span class="pre">SET</span> <span class="pre">SESSION</span> <span class="pre">tx_isolation='REPEATABLE-READ';</span> <span class="pre">COMMIT;</span></code>. Please also make sure there are no other session are changing this configuration.</p>
</section>
<section id="q4-mysql8-0-public-key-retrieval-is-not-allowed">
<h3>Q4: Mysql8.0 Public Key Retrieval is not allowed ?<a class="headerlink" href="#q4-mysql8-0-public-key-retrieval-is-not-allowed" title="Permalink to this headline">¶</a></h3>
<p>This is because the MySQL user account uses <code class="docutils literal notranslate"><span class="pre">sha256_password</span></code> authentication which requires transporting password under protection like TLS protocol. A simple way is to enable the MySQL user account use naive password.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- MySQL</span>
<span class="k">ALTER</span> <span class="k">USER</span> <span class="s1">&#39;username&#39;</span><span class="o">@</span><span class="s1">&#39;localhost&#39;</span> <span class="n">IDENTIFIED</span> <span class="k">WITH</span> <span class="n">mysql_native_password</span> <span class="k">BY</span> <span class="s1">&#39;password&#39;</span><span class="p">;</span>
<span class="n">FLUSH</span> <span class="k">PRIVILEGES</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="q5-how-to-config-tablelist-option-when-build-mysql-cdc-source-in-datastream-api">
<h3>Q5: How to config <code class="docutils literal notranslate"><span class="pre">tableList</span></code> option when build MySQL CDC source in DataStream API?<a class="headerlink" href="#q5-how-to-config-tablelist-option-when-build-mysql-cdc-source-in-datastream-api" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">tableList</span></code> option requires table name with database name rather than table name in DataStream API. For MySQL CDC source, the <code class="docutils literal notranslate"><span class="pre">tableList</span></code> option value should  like ‘my_db.my_table’.</p>
</section>
<section id="q6-how-to-config-mysql-server-timezone-in-datastream-api">
<h3>Q6: How to config MySQL server timezone in DataStream API?<a class="headerlink" href="#q6-how-to-config-mysql-server-timezone-in-datastream-api" title="Permalink to this headline">¶</a></h3>
<p>The timezone of MySQL server influences the data value of TIMESTAMP column in its binlog file, thus we need to consider the MySQL server timezone when deal record that contains TIMESTAMP column. You can refer <code class="docutils literal notranslate"><span class="pre">com.ververica.cdc.debezium.table.RowDataDebeziumDeserializeSchema</span></code> as an example  when you define your custom deserializer to deal binlog data correctly.</p>
</section>
</section>
</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="postgres-cdc.html" class="btn btn-neutral float-right" title="Postgres CDC Connector" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="index.html" class="btn btn-neutral float-left" title="Connectors" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2023, ververica.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  <!--
  ~ Licensed to the Apache Software Foundation (ASF) under one
  ~ or more contributor license agreements.  See the NOTICE file
  ~ distributed with this work for additional information
  ~ regarding copyright ownership.  The ASF licenses this file
  ~ to you under the Apache License, Version 2.0 (the
  ~ "License"); you may not use this file except in compliance
  ~ with the License.  You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
-->



<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      version: release-2.1
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        
        <dl>
            <dt>Versions</dt>
            
            
            <dd><a href="/flink-cdc-connectors/master/">master</a></dd>
            
            
            
            <dd><a href="/flink-cdc-connectors/release-1.4/">release-1.4</a></dd>
            
            
            
            <dd><a href="/flink-cdc-connectors/release-2.0/">release-2.0</a></dd>
            
            
             <strong> 
            <dd><a href="/flink-cdc-connectors/release-2.1/">release-2.1</a></dd>
             </strong> 
            
            
            <dd><a href="/flink-cdc-connectors/release-2.2/">release-2.2</a></dd>
            
            
            
            <dd><a href="/flink-cdc-connectors/release-2.3/">release-2.3</a></dd>
            
            
            
            <dd><a href="/flink-cdc-connectors/release-2.4/">release-2.4</a></dd>
            
            
        </dl>
        
        
        <hr/>
        Free document hosting provided by <a href="http://www.readthedocs.org">Read the
        Docs</a>.

    </div>
</div>

<!-- Place this tag in your head or just before your close body tag. -->
<script async defer
        src="https://ververica.github.io/flink-cdc-connectors/release-2.1/_static/button.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>